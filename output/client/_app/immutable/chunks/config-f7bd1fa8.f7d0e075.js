var fr=function(){function r(){this.keyToValue=new Map,this.valueToKey=new Map}return r.prototype.set=function(n,e){this.keyToValue.set(n,e),this.valueToKey.set(e,n)},r.prototype.getByKey=function(n){return this.keyToValue.get(n)},r.prototype.getByValue=function(n){return this.valueToKey.get(n)},r.prototype.clear=function(){this.keyToValue.clear(),this.valueToKey.clear()},r}(),j=function(){function r(n){this.generateIdentifier=n,this.kv=new fr}return r.prototype.register=function(n,e){this.kv.getByValue(n)||(e||(e=this.generateIdentifier(n)),this.kv.set(e,n))},r.prototype.clear=function(){this.kv.clear()},r.prototype.getIdentifier=function(n){return this.kv.getByValue(n)},r.prototype.getValue=function(n){return this.kv.getByKey(n)},r}(),lr=globalThis&&globalThis.__extends||function(){var r=function(n,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var a in i)Object.prototype.hasOwnProperty.call(i,a)&&(t[a]=i[a])},r(n,e)};return function(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");r(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}}(),cr=function(r){lr(n,r);function n(){var e=r.call(this,function(t){return t.name})||this;return e.classToAllowedProps=new Map,e}return n.prototype.register=function(e,t){typeof t=="object"?(t.allowProps&&this.classToAllowedProps.set(e,t.allowProps),r.prototype.register.call(this,e,t.identifier)):r.prototype.register.call(this,e,t)},n.prototype.getAllowedProps=function(e){return this.classToAllowedProps.get(e)},n}(j),vr=globalThis&&globalThis.__read||function(r,n){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var t=e.call(r),i,a=[],o;try{for(;(n===void 0||n-- >0)&&!(i=t.next()).done;)a.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(e=t.return)&&e.call(t)}finally{if(o)throw o.error}}return a};function yr(r){if("values"in Object)return Object.values(r);var n=[];for(var e in r)r.hasOwnProperty(e)&&n.push(r[e]);return n}function gr(r,n){var e=yr(r);if("find"in e)return e.find(n);for(var t=e,i=0;i<t.length;i++){var a=t[i];if(n(a))return a}}function O(r,n){Object.entries(r).forEach(function(e){var t=vr(e,2),i=t[0],a=t[1];return n(a,i)})}function S(r,n){return r.indexOf(n)!==-1}function z(r,n){for(var e=0;e<r.length;e++){var t=r[e];if(n(t))return t}}var pr=function(){function r(){this.transfomers={}}return r.prototype.register=function(n){this.transfomers[n.name]=n},r.prototype.findApplicable=function(n){return gr(this.transfomers,function(e){return e.isApplicable(n)})},r.prototype.findByName=function(n){return this.transfomers[n]},r}(),dr=function(r){return Object.prototype.toString.call(r).slice(8,-1)},H=function(r){return typeof r>"u"},mr=function(r){return r===null},R=function(r){return typeof r!="object"||r===null||r===Object.prototype?!1:Object.getPrototypeOf(r)===null?!0:r.constructor===Object&&Object.getPrototypeOf(r)===Object.prototype},V=function(r){return R(r)&&Object.keys(r).length===0},m=function(r){return Array.isArray(r)},hr=function(r){return typeof r=="string"},br=function(r){return typeof r=="number"&&!isNaN(r)},wr=function(r){return typeof r=="boolean"},_r=function(r){return r instanceof RegExp},T=function(r){return r instanceof Map},A=function(r){return r instanceof Set},G=function(r){return dr(r)==="Symbol"},Or=function(r){return r instanceof Date&&!isNaN(r.valueOf())},Er=function(r){return r instanceof Error},K=function(r){return typeof r=="number"&&isNaN(r)},L=function(r){return wr(r)||mr(r)||H(r)||br(r)||hr(r)||G(r)},Rr=function(r){return typeof r=="bigint"},Tr=function(r){return r===1/0||r===-1/0},Ar=function(r){return ArrayBuffer.isView(r)&&!(r instanceof DataView)},Ir=function(r){return r instanceof URL},W=function(r){return r.replace(/\./g,"\\.")},P=function(r){return r.map(String).map(W).join(".")},E=function(r){for(var n=[],e="",t=0;t<r.length;t++){var i=r.charAt(t),a=i==="\\"&&r.charAt(t+1)===".";if(a){e+=".",t++;continue}var o=i===".";if(o){n.push(e),e="";continue}e+=i}var u=e;return n.push(u),n},D=globalThis&&globalThis.__assign||function(){return D=Object.assign||function(r){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},D.apply(this,arguments)},C=globalThis&&globalThis.__read||function(r,n){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var t=e.call(r),i,a=[],o;try{for(;(n===void 0||n-- >0)&&!(i=t.next()).done;)a.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(e=t.return)&&e.call(t)}finally{if(o)throw o.error}}return a},U=globalThis&&globalThis.__spreadArray||function(r,n){for(var e=0,t=n.length,i=r.length;e<t;e++,i++)r[i]=n[e];return r};function s(r,n,e,t){return{isApplicable:r,annotation:n,transform:e,untransform:t}}var Z=[s(H,"undefined",function(){return null},function(){}),s(Rr,"bigint",function(r){return r.toString()},function(r){return typeof BigInt<"u"?BigInt(r):(console.error("Please add a BigInt polyfill."),r)}),s(Or,"Date",function(r){return r.toISOString()},function(r){return new Date(r)}),s(Er,"Error",function(r,n){var e={name:r.name,message:r.message};return n.allowedErrorProps.forEach(function(t){e[t]=r[t]}),e},function(r,n){var e=new Error(r.message);return e.name=r.name,e.stack=r.stack,n.allowedErrorProps.forEach(function(t){e[t]=r[t]}),e}),s(_r,"regexp",function(r){return""+r},function(r){var n=r.slice(1,r.lastIndexOf("/")),e=r.slice(r.lastIndexOf("/")+1);return new RegExp(n,e)}),s(A,"set",function(r){return U([],C(r.values()))},function(r){return new Set(r)}),s(T,"map",function(r){return U([],C(r.entries()))},function(r){return new Map(r)}),s(function(r){return K(r)||Tr(r)},"number",function(r){return K(r)?"NaN":r>0?"Infinity":"-Infinity"},Number),s(function(r){return r===0&&1/r===-1/0},"number",function(){return"-0"},Number),s(Ir,"URL",function(r){return r.toString()},function(r){return new URL(r)})];function N(r,n,e,t){return{isApplicable:r,annotation:n,transform:e,untransform:t}}var X=N(function(r,n){if(G(r)){var e=!!n.symbolRegistry.getIdentifier(r);return e}return!1},function(r,n){var e=n.symbolRegistry.getIdentifier(r);return["symbol",e]},function(r){return r.description},function(r,n,e){var t=e.symbolRegistry.getValue(n[1]);if(!t)throw new Error("Trying to deserialize unknown symbol");return t}),Sr=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,Uint8ClampedArray].reduce(function(r,n){return r[n.name]=n,r},{}),J=N(Ar,function(r){return["typed-array",r.constructor.name]},function(r){return U([],C(r))},function(r,n){var e=Sr[n[1]];if(!e)throw new Error("Trying to deserialize unknown typed array");return new e(r)});function rr(r,n){if(r!=null&&r.constructor){var e=!!n.classRegistry.getIdentifier(r.constructor);return e}return!1}var nr=N(rr,function(r,n){var e=n.classRegistry.getIdentifier(r.constructor);return["class",e]},function(r,n){var e=n.classRegistry.getAllowedProps(r.constructor);if(!e)return D({},r);var t={};return e.forEach(function(i){t[i]=r[i]}),t},function(r,n,e){var t=e.classRegistry.getValue(n[1]);if(!t)throw new Error("Trying to deserialize unknown class - check https://github.com/blitz-js/superjson/issues/116#issuecomment-773996564");return Object.assign(Object.create(t.prototype),r)}),er=N(function(r,n){return!!n.customTransformerRegistry.findApplicable(r)},function(r,n){var e=n.customTransformerRegistry.findApplicable(r);return["custom",e.name]},function(r,n){var e=n.customTransformerRegistry.findApplicable(r);return e.serialize(r)},function(r,n,e){var t=e.customTransformerRegistry.findByName(n[1]);if(!t)throw new Error("Trying to deserialize unknown custom value");return t.deserialize(r)}),Nr=[nr,X,er,J],M=function(r,n){var e=z(Nr,function(i){return i.isApplicable(r,n)});if(e)return{value:e.transform(r,n),type:e.annotation(r,n)};var t=z(Z,function(i){return i.isApplicable(r,n)});if(t)return{value:t.transform(r,n),type:t.annotation}},tr={};Z.forEach(function(r){tr[r.annotation]=r});var Pr=function(r,n,e){if(m(n))switch(n[0]){case"symbol":return X.untransform(r,n,e);case"class":return nr.untransform(r,n,e);case"custom":return er.untransform(r,n,e);case"typed-array":return J.untransform(r,n,e);default:throw new Error("Unknown transformation: "+n)}else{var t=tr[n];if(!t)throw new Error("Unknown transformation: "+n);return t.untransform(r,e)}},_=function(r,n){for(var e=r.keys();n>0;)e.next(),n--;return e.next().value};function ir(r){if(S(r,"__proto__"))throw new Error("__proto__ is not allowed as a property");if(S(r,"prototype"))throw new Error("prototype is not allowed as a property");if(S(r,"constructor"))throw new Error("constructor is not allowed as a property")}var Vr=function(r,n){ir(n);for(var e=0;e<n.length;e++){var t=n[e];if(A(r))r=_(r,+t);else if(T(r)){var i=+t,a=+n[++e]==0?"key":"value",o=_(r,i);switch(a){case"key":r=o;break;case"value":r=r.get(o);break}}else r=r[t]}return r},k=function(r,n,e){if(ir(n),n.length===0)return e(r);for(var t=r,i=0;i<n.length-1;i++){var a=n[i];if(m(t)){var o=+a;t=t[o]}else if(R(t))t=t[a];else if(A(t)){var u=+a;t=_(t,u)}else if(T(t)){var c=i===n.length-2;if(c)break;var u=+a,f=+n[++i]==0?"key":"value",v=_(t,u);switch(f){case"key":t=v;break;case"value":t=t.get(v);break}}}var w=n[n.length-1];if((m(t)||R(t))&&(t[w]=e(t[w])),A(t)){var y=_(t,+w),g=e(y);y!==g&&(t.delete(y),t.add(g))}if(T(t)){var u=+n[n.length-2],p=_(t,u),f=+w==0?"key":"value";switch(f){case"key":{var I=e(p);t.set(I,t.get(p)),I!==p&&t.delete(p);break}case"value":{t.set(p,e(t.get(p)));break}}}return r},l=globalThis&&globalThis.__read||function(r,n){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var t=e.call(r),i,a=[],o;try{for(;(n===void 0||n-- >0)&&!(i=t.next()).done;)a.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(e=t.return)&&e.call(t)}finally{if(o)throw o.error}}return a},d=globalThis&&globalThis.__spreadArray||function(r,n){for(var e=0,t=n.length,i=r.length;e<t;e++,i++)r[i]=n[e];return r};function B(r,n,e){if(e===void 0&&(e=[]),!!r){if(!m(r)){O(r,function(o,u){return B(o,n,d(d([],l(e)),l(E(u))))});return}var t=l(r,2),i=t[0],a=t[1];a&&O(a,function(o,u){B(o,n,d(d([],l(e)),l(E(u))))}),n(i,e)}}function Dr(r,n,e){return B(n,function(t,i){r=k(r,i,function(a){return Pr(a,t,e)})}),r}function Cr(r,n){function e(o,u){var c=Vr(r,E(u));o.map(E).forEach(function(f){r=k(r,f,function(){return c})})}if(m(n)){var t=l(n,2),i=t[0],a=t[1];i.forEach(function(o){r=k(r,E(o),function(){return r})}),a&&O(a,e)}else O(n,e);return r}var Ur=function(r,n){return R(r)||m(r)||T(r)||A(r)||rr(r,n)};function kr(r,n,e){var t=e.get(r);t?t.push(n):e.set(r,[n])}function Br(r){var n={},e=void 0;return r.forEach(function(t){if(!(t.length<=1)){var i=l(t.map(function(u){return u.map(String)}).sort(function(u,c){return u.length-c.length})),a=i[0],o=i.slice(1);a.length===0?e=o.map(P):n[P(a)]=o.map(P)}}),e?V(n)?[e]:[e,n]:V(n)?void 0:n}var ar=function(r,n,e,t,i){var a;if(t===void 0&&(t=[]),i===void 0&&(i=[]),L(r)||kr(r,t,n),!Ur(r,e)){var o=M(r,e);return o?{transformedValue:o.value,annotations:[o.type]}:{transformedValue:r}}if(S(i,r))return{transformedValue:null};var u=M(r,e),c=(a=u==null?void 0:u.value)!==null&&a!==void 0?a:r;L(r)||(i=d(d([],l(i)),[r]));var f=m(c)?[]:{},v={};return O(c,function(w,y){var g=ar(w,n,e,d(d([],l(t)),[y]),i);f[y]=g.transformedValue,m(g.annotations)?v[y]=g.annotations:R(g.annotations)&&O(g.annotations,function(p,I){v[W(y)+"."+I]=p})}),V(v)?{transformedValue:f,annotations:u?[u.type]:void 0}:{transformedValue:f,annotations:u?[u.type,v]:v}};function or(r){return Object.prototype.toString.call(r).slice(8,-1)}function xr(r){if(or(r)!=="Object")return!1;const n=Object.getPrototypeOf(r);return n.constructor===Object&&n===Object.prototype}function $(r){return or(r)==="Array"}function zr(r,n,e,t,i){const a={}.propertyIsEnumerable.call(t,n)?"enumerable":"nonenumerable";a==="enumerable"&&(r[n]=e),i&&a==="nonenumerable"&&Object.defineProperty(r,n,{value:e,enumerable:!1,writable:!0,configurable:!0})}function x(r,n={}){if($(r))return r.map(i=>x(i,n));if(!xr(r))return r;const e=Object.getOwnPropertyNames(r),t=Object.getOwnPropertySymbols(r);return[...e,...t].reduce((i,a)=>{if($(n.props)&&!n.props.includes(a))return i;const o=r[a],u=x(o,n);return zr(i,a,u,r,n.nonenumerable),i},{})}var b=globalThis&&globalThis.__assign||function(){return b=Object.assign||function(r){for(var n,e=1,t=arguments.length;e<t;e++){n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r},b.apply(this,arguments)},Kr=globalThis&&globalThis.__read||function(r,n){var e=typeof Symbol=="function"&&r[Symbol.iterator];if(!e)return r;var t=e.call(r),i,a=[],o;try{for(;(n===void 0||n-- >0)&&!(i=t.next()).done;)a.push(i.value)}catch(u){o={error:u}}finally{try{i&&!i.done&&(e=t.return)&&e.call(t)}finally{if(o)throw o.error}}return a},Lr=globalThis&&globalThis.__spreadArray||function(r,n){for(var e=0,t=n.length,i=r.length;e<t;e++,i++)r[i]=n[e];return r},h=function(){function r(){this.classRegistry=new cr,this.symbolRegistry=new j(function(n){var e;return(e=n.description)!==null&&e!==void 0?e:""}),this.customTransformerRegistry=new pr,this.allowedErrorProps=[]}return r.prototype.serialize=function(n){var e=new Map,t=ar(n,e,this),i={json:t.transformedValue};t.annotations&&(i.meta=b(b({},i.meta),{values:t.annotations}));var a=Br(e);return a&&(i.meta=b(b({},i.meta),{referentialEqualities:a})),i},r.prototype.deserialize=function(n){var e=n.json,t=n.meta,i=x(e);return t!=null&&t.values&&(i=Dr(i,t.values,this)),t!=null&&t.referentialEqualities&&(i=Cr(i,t.referentialEqualities)),i},r.prototype.stringify=function(n){return JSON.stringify(this.serialize(n))},r.prototype.parse=function(n){return this.deserialize(JSON.parse(n))},r.prototype.registerClass=function(n,e){this.classRegistry.register(n,e)},r.prototype.registerSymbol=function(n,e){this.symbolRegistry.register(n,e)},r.prototype.registerCustom=function(n,e){this.customTransformerRegistry.register(b({name:e},n))},r.prototype.allowErrorProps=function(){for(var n,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];(n=this.allowedErrorProps).push.apply(n,Lr([],Kr(e)))},r.defaultInstance=new r,r.serialize=r.defaultInstance.serialize.bind(r.defaultInstance),r.deserialize=r.defaultInstance.deserialize.bind(r.defaultInstance),r.stringify=r.defaultInstance.stringify.bind(r.defaultInstance),r.parse=r.defaultInstance.parse.bind(r.defaultInstance),r.registerClass=r.defaultInstance.registerClass.bind(r.defaultInstance),r.registerSymbol=r.defaultInstance.registerSymbol.bind(r.defaultInstance),r.registerCustom=r.defaultInstance.registerCustom.bind(r.defaultInstance),r.allowErrorProps=r.defaultInstance.allowErrorProps.bind(r.defaultInstance),r}();h.serialize;h.deserialize;h.stringify;h.parse;h.registerClass;h.registerCustom;h.registerSymbol;h.allowErrorProps;function ur(r){const n=Object.create(null);for(const e in r){const t=r[e];n[t]=e}return n}const sr={PARSE_ERROR:-32700,BAD_REQUEST:-32600,INTERNAL_SERVER_ERROR:-32603,UNAUTHORIZED:-32001,FORBIDDEN:-32003,NOT_FOUND:-32004,METHOD_NOT_SUPPORTED:-32005,TIMEOUT:-32008,CONFLICT:-32009,PRECONDITION_FAILED:-32012,PAYLOAD_TOO_LARGE:-32013,TOO_MANY_REQUESTS:-32029,CLIENT_CLOSED_REQUEST:-32099};ur(sr);ur(sr);var q,F,Y,Q;typeof window>"u"||"Deno"in window||((F=(q=globalThis.process)==null?void 0:q.env)==null?void 0:F.NODE_ENV)==="test"||(Q=(Y=globalThis.process)==null?void 0:Y.env)!=null&&Q.JEST_WORKER_ID;export{h as S};
